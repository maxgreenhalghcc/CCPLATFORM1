# Custom Cocktails v1.0.0

_Date:_ 2025-07-09

## Highlights
- End-to-end customer journey: personalised quiz, Stripe Checkout, webhook processing, and staff fulfilment.
- Multi-tenant venue management with theming, pricing, ingredient whitelists, and staff/admin auth via NextAuth + NestJS guards.
- Observability-ready stack: JWT-secured recipe engine, structured logging, rate limiting, and Sentry hooks.
- CI/CD pipelines producing GHCR images, environment-specific configuration, and production-ready Docker Compose deployment.

## Required configuration changes
- Populate `.env.production` (or GitHub environment secrets) with the variables listed in the README environment matrix, including Stripe, NextAuth, JWT, and database credentials.
- Configure Stripe Checkout success/cancel URLs to point at `/checkout/success` and `/checkout/cancel` on your public web domain.
- Provision recipe engine secrets: `RECIPE_JWT_SECRET`, `RECIPE_JWT_AUDIENCE=recipe-engine`, `RECIPE_JWT_ISSUER=custom-cocktails-api`.

## Deployment checklist
1. Ensure CI (`ci.yml`) has completed and pushed `v1.0.0` images to GHCR.
2. Prepare `.env.production` on the target host (or secrets in GitHub Environments).
3. Trigger the deployment workflow:
   ```bash
   gh workflow run deploy.yml \
     -R <owner>/<repo> \
     -f environment=production \
     -f tag=v1.0.0
   ```
4. After deployment, run `./scripts/smoke.sh https://<api-domain>/v1 demo-bar` and execute the manual payment + fulfilment flow.
5. Tag any follow-up hotfixes as `v1.0.x` and redeploy using the same workflow.

## Known follow-ups
- Harden realtime staff updates (WebSocket/SSE).
- Expand analytics to include ingredient usage and conversion funnels.
- Automate Stripe webhook smoke tests in CI.

